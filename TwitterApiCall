#Call packages
pkgs <- c('twitteR','RJSONIO','bitops','RCurl','ROAuth','streamR')
lapply(pkgs, library, character.only=T)

# Set SSL certs globally
options(RCurlOptions = list(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl")))

#Access
reqURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumerKey <- "7zLygd5r2NQG9UAigGOBtnKtV"
consumerSecret <- "YbGE3zzYQrD46yZMEl7AbOFbnXzLsCX7Aa3SBZe8c76p15NsI9"
twitCred <- OAuthFactory$new(consumerKey=consumerKey,
                             consumerSecret=consumerSecret,
                             requestURL=reqURL,
                             accessURL=accessURL,
                             authURL=authURL)
#Log in
twitCred$handshake()

#Validate credentials
registerTwitterOAuth(twitCred)

#Create data frame from tweet search
HistTweets <- twListToDF(searchTwitter('#rstats',n=1000))

#OR Search Streaming API
filterStream(file.name = 'Tweets.json', track = 'dwarf fortress', timeout = 5, oauth = twitCred)

#Convert streaming JSON to R list
read <- readTweets('Tweets.json')

#Convert R list to data frame 
StreamTweets <- parseTweets('Tweets.json')

#Write either data frame (Histtweets or StreamTweets) to CSV
write.csv(HistTweets,'Tweets.csv')

#Send private tweet to myself
sendTweet <- dmSend('I'm awesome!','Mario_Carloni')
sendTweet
